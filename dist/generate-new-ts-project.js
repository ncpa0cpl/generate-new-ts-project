#!/usr/bin/env bun
"use strict";var dn=Object.create;var Ot=Object.defineProperty;var gn=Object.getOwnPropertyDescriptor;var hn=Object.getOwnPropertyNames;var wn=Object.getPrototypeOf,bn=Object.prototype.hasOwnProperty;var yn=(r,t,e)=>t in r?Ot(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var i=(r,t)=>Ot(r,"name",{value:t,configurable:!0});var D=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Nn=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of hn(t))!bn.call(r,o)&&o!==e&&Ot(r,o,{get:()=>t[o],enumerable:!(n=gn(t,o))||n.enumerable});return r};var f=(r,t,e)=>(e=r!=null?dn(wn(r)):{},Nn(t||!r||!r.__esModule?Ot(e,"default",{value:r,enumerable:!0}):e,r));var c=(r,t,e)=>yn(r,typeof t!="symbol"?t+"":t,e);var Q=D(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.Clify=Y.ClifyGlobals=void 0;function _n(){return{read(){let r="",t=process.stdin,e=t.readableEncoding??void 0;t.setEncoding("utf8");let n=i(o=>{r+=o},"onData");return t.on("data",n),new Promise(o=>{t.once("end",()=>{t.removeListener("data",n),t.setEncoding(e),o(r)})})}}}i(_n,"defaultStdinReader");function vn(){return process.argv.slice(2)}i(vn,"defaultArgGetter");function In(r,t){switch(r){case"info":console.log(...t);break;case"error":console.error(...t);break;case"warning":console.warn(...t);break}}i(In,"defaultLogger");var z=class z{static setArgGetter(t){this.argGetter=t}static setLogger(t){this.logger=t}static setStdinReader(t){this.getStdinReader=t}static getArgs(){return this.argGetter()}static err(...t){this.logger("error",t)}static log(...t){this.logger("info",t)}static warn(...t){this.logger("warning",t)}static getStdin(){return this.getStdinReader()}};i(z,"ClifyGlobals"),c(z,"getStdinReader",_n),c(z,"argGetter",vn),c(z,"logger",In);var Tt=z;Y.ClifyGlobals=Tt;Y.Clify=Tt});var Be=D(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.CmdInput=void 0;var Cn=Q(),re=class re{constructor(t){c(this,"command");c(this,"argumentInput",null);c(this,"stdinInput",null);c(this,"_source",null);this.command=t}setArgumentInput(t){this.argumentInput=t,t!=null&&(this._source="argument")}async prepare(){if(this.argumentInput!=null)return;let t=Cn.ClifyGlobals.getStdin();this._source="stdin",this.stdinInput=await t.read()}validate(){return this.argumentInput!=null||this.stdinInput!=null}get(){return this.argumentInput??this.stdinInput}get source(){return this._source}};i(re,"CmdInput");var ee=re;Pt.CmdInput=ee});var We=D(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.Cmd=void 0;var K=Q(),Sn=Be(),x;(function(r){r[r.HAS_NOTHING=0]="HAS_NOTHING",r[r.HAS_SUBCMD=1]="HAS_SUBCMD",r[r.HAS_INPUT=2]="HAS_INPUT",r[r.HAS_ACTION=4]="HAS_ACTION",r[r.HAS_SUBCMD_INPUT=3]="HAS_SUBCMD_INPUT",r[r.HAS_SUBCMD_ACTION=5]="HAS_SUBCMD_ACTION",r[r.HAS_INPUT_ACTION=6]="HAS_INPUT_ACTION",r[r.HAS_SUBCMD_INPUT_ACTION=7]="HAS_SUBCMD_INPUT_ACTION"})(x||(x={}));var Je=i((r,t)=>r.localeCompare(t),"alphasort"),xt=class xt{constructor(t,e){c(this,"cmdName");c(this,"parentCommand");c(this,"ownOptions",[]);c(this,"ownAction");c(this,"subCommands",[]);c(this,"parsedArgs");c(this,"ownInput");c(this,"description","");this.cmdName=t,this.parentCommand=e}command(t,e){let n=new xt(t,this);return n.ownAction=e(n),this.subCommands.push(n),n}option(t){let e=new t(this);return this.ownOptions.push(e),e}input(){return this.ownInput!=null?this.ownInput:this.ownInput=new Sn.CmdInput(this)}setDescription(t){this.description=t}findSubcommand(t){if(t.length===0)return[this,null];let[e]=t,n=this.subCommands.find(o=>o.cmdName===e);return n==null?this.ownInput&&t.length===1?[this,t[0]]:[null,null]:n.findSubcommand(t.slice(1))}getName(){let t=this.parentCommand?.getName();return t!=null?t+" "+this.cmdName:this.cmdName}printHelp(){let t=K.ClifyGlobals.log.bind(K.ClifyGlobals),e=`Usage: ${this.getName()}`,n=x.HAS_NOTHING;switch(this.subCommands.length>0&&(n|=x.HAS_SUBCMD),this.ownInput&&(n|=x.HAS_INPUT),this.ownAction&&(n|=x.HAS_ACTION),n){case x.HAS_NOTHING:case x.HAS_ACTION:break;case x.HAS_INPUT:case x.HAS_INPUT_ACTION:e+=" INPUT";break;case x.HAS_SUBCMD:e+=" COMMAND";break;case x.HAS_SUBCMD_ACTION:e+=" COMMAND?";break;case x.HAS_SUBCMD_INPUT:e+=" COMMAND|INPUT";break;case x.HAS_SUBCMD_INPUT_ACTION:e+=" COMMAND|INPUT?";break}this.ownOptions.length>0&&(e+=" [...OPTIONS]");let o=[];if(this.subCommands.length>0){let a=this.subCommands.map(d=>`  ${d.cmdName}`),m=a.reduce((d,g)=>d.length>g.length?d:g,"").length;o=a.map((d,g)=>d.padEnd(m+4)+this.subCommands[g].description).sort(Je)}let s=[];if(this.ownOptions.length>0){let a=this.ownOptions.map(d=>`  ${d.getNameWithType()}`),m=a.reduce((d,g)=>d.length>g.length?d:g,"").length;s=a.map((d,g)=>d.padEnd(m+4)+this.ownOptions[g].getDescription()).sort(Je)}if(t(e),this.description&&(t(""),t(this.description)),o.length>0){t(""),t("Commands:");for(let a of o)t(a)}if(s.length>0){t(""),t("Options:");for(let a of s)t(a)}}printUnknownArgsMsg(t){let e=K.ClifyGlobals.err.bind(K.ClifyGlobals);e("Unknown options:"),t.forEach(n=>{n.length===1?e(`  -${n}`):e(`  --${n}`)})}printArgumentErrors(t){let e=K.ClifyGlobals.err.bind(K.ClifyGlobals);e("Invalid options:"),t.forEach(n=>{e(`  ${n.toPrintable()}`)})}async prepare(){if("help"in this.parsedArgs)return this.printHelp(),"skip";let t=Object.keys(this.parsedArgs).filter(o=>o!=="_"&&o!=="__"),e=[];for(let o=0;o<t.length;o++){let s=t[o];this.ownOptions.some(a=>a.nameMatches(s))||e.push(s)}if(e.length>0)return this.printUnknownArgsMsg(e),"fail";let n=[];for(let o=0;o<this.ownOptions.length;o++){let s=this.ownOptions[o].init();s!=null&&n.push(s)}return n.length>0?(this.printArgumentErrors(n),"fail"):this.ownInput?(await this.ownInput.prepare(),this.ownInput.validate()?"ok":"fail"):"ok"}runAction(){return this.ownAction==null?(K.ClifyGlobals.warn("Nothing to do."),Promise.resolve(new Error("Nothing to do."))):this.ownAction()}getParsedArgs(){return this.parsedArgs}async start(t,e){this.parsedArgs=t,this.ownInput?.setArgumentInput(e);let n=await this.prepare();if(n==="ok")return this.runAction();if(n==="fail")return Promise.resolve(new Error("Command failed"))}};i(xt,"Cmd");var ne=xt;Mt.Cmd=ne});var ze=D((_i,qe)=>{"use strict";function On(r,t){var e=r;t.slice(0,-1).forEach(function(o){e=e[o]||{}});var n=t[t.length-1];return n in e}i(On,"hasKey");function Ve(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}i(Ve,"isNumber");function Ke(r,t){return t==="constructor"&&typeof r[t]=="function"||t==="__proto__"}i(Ke,"isConstructorOrProto");qe.exports=function(r,t){t||(t={});var e={bools:{},strings:{},unknownFn:null};typeof t.unknown=="function"&&(e.unknownFn=t.unknown),typeof t.boolean=="boolean"&&t.boolean?e.allBools=!0:[].concat(t.boolean).filter(Boolean).forEach(function(p){e.bools[p]=!0});var n={};function o(p){return n[p].some(function(N){return e.bools[N]})}i(o,"aliasIsBoolean"),Object.keys(t.alias||{}).forEach(function(p){n[p]=[].concat(t.alias[p]),n[p].forEach(function(N){n[N]=[p].concat(n[p].filter(function($){return N!==$}))})}),[].concat(t.string).filter(Boolean).forEach(function(p){e.strings[p]=!0,n[p]&&[].concat(n[p]).forEach(function(N){e.strings[N]=!0})});var s=t.default||{},a={_:[]};function m(p,N){return e.allBools&&/^--[^=]+$/.test(N)||e.strings[p]||e.bools[p]||n[p]}i(m,"argDefined");function d(p,N,$){for(var b=p,ht=0;ht<N.length-1;ht++){var R=N[ht];if(Ke(b,R))return;b[R]===void 0&&(b[R]={}),(b[R]===Object.prototype||b[R]===Number.prototype||b[R]===String.prototype)&&(b[R]={}),b[R]===Array.prototype&&(b[R]=[]),b=b[R]}var L=N[N.length-1];Ke(b,L)||((b===Object.prototype||b===Number.prototype||b===String.prototype)&&(b={}),b===Array.prototype&&(b=[]),b[L]===void 0||e.bools[L]||typeof b[L]=="boolean"?b[L]=$:Array.isArray(b[L])?b[L].push($):b[L]=[b[L],$])}i(d,"setKey");function g(p,N,$){if(!($&&e.unknownFn&&!m(p,$)&&e.unknownFn($)===!1)){var b=!e.strings[p]&&Ve(N)?Number(N):N;d(a,p.split("."),b),(n[p]||[]).forEach(function(ht){d(a,ht.split("."),b)})}}i(g,"setArg"),Object.keys(e.bools).forEach(function(p){g(p,s[p]===void 0?!1:s[p])});var gt=[];r.indexOf("--")!==-1&&(gt=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var _=0;_<r.length;_++){var h=r[_],w,k;if(/^--.+=/.test(h)){var He=h.match(/^--([^=]+)=([\s\S]*)$/);w=He[1];var te=He[2];e.bools[w]&&(te=te!=="false"),g(w,te,h)}else if(/^--no-.+/.test(h))w=h.match(/^--no-(.+)/)[1],g(w,!1,h);else if(/^--.+/.test(h))w=h.match(/^--(.+)/)[1],k=r[_+1],k!==void 0&&!/^(-|--)[^-]/.test(k)&&!e.bools[w]&&!e.allBools&&(!n[w]||!o(w))?(g(w,k,h),_+=1):/^(true|false)$/.test(k)?(g(w,k==="true",h),_+=1):g(w,e.strings[w]?"":!0,h);else if(/^-[^-]+/.test(h)){for(var F=h.slice(1,-1).split(""),St=!1,P=0;P<F.length;P++){if(k=h.slice(P+2),k==="-"){g(F[P],k,h);continue}if(/[A-Za-z]/.test(F[P])&&k[0]==="="){g(F[P],k.slice(1),h),St=!0;break}if(/[A-Za-z]/.test(F[P])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(k)){g(F[P],k,h),St=!0;break}if(F[P+1]&&F[P+1].match(/\W/)){g(F[P],h.slice(P+2),h),St=!0;break}else g(F[P],e.strings[F[P]]?"":!0,h)}w=h.slice(-1)[0],!St&&w!=="-"&&(r[_+1]&&!/^(-|--)[^-]/.test(r[_+1])&&!e.bools[w]&&(!n[w]||!o(w))?(g(w,r[_+1],h),_+=1):r[_+1]&&/^(true|false)$/.test(r[_+1])?(g(w,r[_+1]==="true",h),_+=1):g(w,e.strings[w]?"":!0,h))}else if((!e.unknownFn||e.unknownFn(h)!==!1)&&a._.push(e.strings._||!Ve(h)?h:Number(h)),t.stopEarly){a._.push.apply(a._,r.slice(_+1));break}}return Object.keys(s).forEach(function(p){On(a,p.split("."))||(d(a,p.split("."),s[p]),(n[p]||[]).forEach(function(N){d(a,N.split("."),s[p])}))}),t["--"]?a["--"]=gt.slice():gt.forEach(function(p){a._.push(p)}),a}});var Qe=D(Z=>{"use strict";var Tn=Z&&Z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Z,"__esModule",{value:!0});Z.ClifyProgram=void 0;var Pn=Tn(ze()),Ye=Q(),se=class se{constructor(t){c(this,"mainCommand");this.mainCommand=t}init(t,e){return t!=null?{_:t.split(" "),...e}:(0,Pn.default)(Ye.ClifyGlobals.getArgs())}findCommand(t){return this.mainCommand.findSubcommand(t)}run(t,e){let n=this.init(t,e);if(n.version)return this.mainCommand.printVersionInfo(),Promise.resolve();let[o,s]=this.findCommand(n._);if(o==null){let a=`Unknown command: ${n._.join(" ")}`;return Ye.ClifyGlobals.err(a),Promise.resolve(new Error(a))}return o.start(n,s)}};i(se,"ClifyProgram");var ie=se;Z.ClifyProgram=ie});var Ze=D(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.assertNotAsync=void 0;function xn(r,t){if(r instanceof Promise)throw new Error(`'${t}' cannot be asynchronous.`)}i(xn,"assertNotAsync");Et.assertNotAsync=xn});var Xe=D(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.configure=X.MainCmd=void 0;var Mn=Q(),En=We(),kn=Qe(),An=Ze(),oe=class oe extends En.Cmd{constructor(){super(...arguments);c(this,"version");c(this,"programName")}printVersionInfo(){let e="";this.programName!=null&&(e=`${this.programName} `),this.version!=null&&(e+=`${this.version} `),Mn.ClifyGlobals.log(e)}setVersion(e){this.version=e}setName(e){this.programName=e}main(e){this.ownAction=e(this)}getName(){return this.programName??""}};i(oe,"MainCmd");var kt=oe;X.MainCmd=kt;function Fn(r){let t=new kt("");return(0,An.assertNotAsync)(r(t),"configureCallback"),new kn.ClifyProgram(t)}i(Fn,"configure");X.configure=Fn});var me=D(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.UnspecifiedOptionError=B.InvalidOptionError=B.OptionError=void 0;var pe=class pe extends Error{constructor(e,n){super(e);c(this,"optionName");c(this,"customMessage");this.optionName=n}toPrintable(){return`${this.customMessage??this.message}: ${this.optionName}`}};i(pe,"OptionError");var wt=pe;B.OptionError=wt;var le=class le extends wt{constructor(e,n,o,s){super(`Invalid option, expected '${n}', but received '${o}'`,e);c(this,"expected");c(this,"received");c(this,"customMessage");this.expected=n,this.received=o,this.customMessage=s,this.name="InvalidOptionError"}};i(le,"InvalidOptionError");var ae=le;B.InvalidOptionError=ae;var ue=class ue extends wt{constructor(e){super("Unspecified option",e);c(this,"optionName");this.optionName=e,this.name="UnspecifiedOptionError"}};i(ue,"UnspecifiedOptionError");var ce=ue;B.UnspecifiedOptionError=ce});var tr=D(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.convertOptionValue=void 0;var bt=me();function fe(r,t,e){if(Array.isArray(t)){if(!Array.isArray(r)){let o=fe(r,t[0],e);return typeof o=="object"?o:[o]}let n=[];for(let o of r){let s=fe(o,t[0],e);if(typeof s=="object")return s;n.push(s)}return n}else{if(Array.isArray(r))return new bt.InvalidOptionError(e,"single value","multiple");switch(t){case"string":return String(r);case"boolean":return typeof r!="boolean"?new bt.InvalidOptionError(e,"boolean",typeof r):r;case"number":return typeof r!="number"||Number.isNaN(r)?new bt.InvalidOptionError(e,"number",typeof r):r;case"int":return typeof r!="number"||Number.isNaN(r)?new bt.InvalidOptionError(e,"integer",typeof r):Number.isInteger(r)?r:new bt.InvalidOptionError(e,"integer","float");case"unknown":return r}}throw Error("unreachable")}i(fe,"convertOptionValue");At.convertOptionValue=fe});var rr=D(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.defineOption=tt.Opt=void 0;var er=tr(),Ft=me(),jt=class jt{constructor(t){c(this,"command");c(this,"initParams");c(this,"_value");c(this,"_isSet",!1);c(this,"_default");this.command=t,this.initParams=this.getInitParams()}static define(t){return class extends jt{getInitParams(){return t}}}get value(){return this._isSet?this._value:this._default}get isSet(){return this._isSet}setDefault(t){return this._default=t,this}init(){let t=this.getName(),e=this.command.getParsedArgs();if(this._default=this.initParams.default,this.initParams.name in e){let n=(0,er.convertOptionValue)(e[this.initParams.name],this.initParams.type,t);if(n instanceof Ft.OptionError)return n;this._isSet=!0,this._value=n}else if(this.initParams.char!=null&&this.initParams.char in e){this._isSet=!0;let n=(0,er.convertOptionValue)(e[this.initParams.char],this.initParams.type,t);if(n instanceof Ft.OptionError)return n;this._isSet=!0,this._value=n}else if(this.initParams.required&&this._default==null)return new Ft.UnspecifiedOptionError(t);return this.validate()}validate(){if(this.initParams.validate&&this._isSet){let t=this.initParams.validate(this.value);return t==="ok"?null:new Ft.InvalidOptionError(this.getName(),t.expected,t.received,t.message)}return null}nameMatches(t){return this.initParams.name===t||t.length===1&&this.initParams.char===t}getName(){return this.initParams.char!=null?`--${this.initParams.name}, -${this.initParams.char}`:`--${this.initParams.name}`}getNameWithType(){if(this.initParams.type==="boolean")return this.initParams.char!=null?`--${this.initParams.name}, -${this.initParams.char}`:`--${this.initParams.name}`;let t;return Array.isArray(this.initParams.type)?t="..."+this.initParams.type[0]:t=this.initParams.type,this.initParams.char!=null?`--${this.initParams.name}, -${this.initParams.char} <${t}>`:`--${this.initParams.name} <${t}>`}getDescription(){return this.initParams.description||""}};i(jt,"Opt");var Dt=jt;tt.Opt=Dt;function Dn(r){return Dt.define(r)}i(Dn,"defineOption");tt.defineOption=Dn});var de=D(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.defineOption=J.configure=J.Clify=void 0;var jn=Q();Object.defineProperty(J,"Clify",{enumerable:!0,get:i(function(){return jn.Clify},"get")});var Rn=Xe();Object.defineProperty(J,"configure",{enumerable:!0,get:i(function(){return Rn.configure},"get")});var Gn=rr();Object.defineProperty(J,"defineOption",{enumerable:!0,get:i(function(){return Gn.defineOption},"get")})});var mn=f(de()),fn=f(require("path"));var vt=f(de());var Jr=f(require("path"));var ge=class ge{constructor(t,e,n="."){this.getContent=t;this.filename=e;this.location=n}getAsString(t){let e=this.getContent(t);return typeof e=="string"?e:JSON.stringify(e,null,2)}};i(ge,"ConfigFile");var u=ge;var yt=class yt{constructor(t,e={}){this.name=t;this.options=e;var n,o;(n=this.options).register??(n.register="npm"),(o=this.options).version??(o.version="latest")}static setPackageManagerType(t,e=""){this.pmType=t,this.pmVersion=e}getNameForNpmRegister(){return!this.options.version||this.options.version==="latest"?this.name:`${this.name}@${this.options.version}`}getNameForGithubRegister(){let t;return yt.pmType==="yarn"&&yt.pmVersion.startsWith("3")?t=`${this.name}@${this.options.user}/${this.name}`:t=`git+https://github.com/${this.options.user}/${this.name}`,this.options.version&&this.options.version!=="latest"&&(t+=`#${this.options.version}`),t}getFriendlyName(){return this.options.version==="latest"?this.name:`${this.name} v${this.options.version}`}getInstallName(){return this.options.register==="github"?this.getNameForGithubRegister():this.getNameForNpmRegister()}};i(yt,"Dependency");var l=yt;var M=i(r=>typeof r=="object"&&r!==null,"isRecord");var nr={lineWidth:80,typescript:{},json:{},markdown:{},excludes:["**/node_modules","**/*-lock.json","**/dist"],plugins:["https://plugins.dprint.dev/typescript-0.88.7.wasm","https://plugins.dprint.dev/json-0.19.1.wasm","https://plugins.dprint.dev/markdown-0.16.3.wasm"]};var he=class he{getName(){return"dprint"}getDevDependencies(){return[new l("dprint")]}getConfigFiles(){return[new u(()=>nr,"dprint.json")]}packageJsonMiddleware(t){return t.addScript("fix:fmt","dprint fmt"),t.addScript("test:fmt","dprint check"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Check Formatting",script:"test:fmt"})}};i(he,"DprintModule");var Rt=he;var sr=f(require("fs/promises")),or=f(require("path"));var G=i((...r)=>{let t=r[0],e="",n=0,o=0;for(e=t[0],n=1,o=r.length;n<o;n++)e+=String(r[n])+t[n];return e.trim()+`
`},"js");var ir=G`
import esbuild from "esbuild";
import path from "node:path";
import { fileURLToPath } from "url";

const __dirname = path.dirname(fileURLToPath(import.meta.url));
const p = (...fpath) => path.resolve(__dirname, "..", ...fpath);

const isDev = process.argv.includes("--dev");
const watch = process.argv.includes("--watch");

async function main() {
  /** 
   * @type {import("esbuild").BuildOptions} 
   */
  const bldOptions = {
    tsconfig: p("tsconfig.json"),
    entryPoints: [p("src/index.ts")],
    outdir: p("dist"),
    bundle: true,
    keepNames: true,
    treeShaking: !isDev,
    minify: !isDev,
  }

  if (watch) {
    const buildCtx = await esbuild.context(bldOptions);
    await buildCtx.watch();
  } else {
    await esbuild.build(bldOptions);
  }
}

main().catch((err) => {
  console.error(err);
  process.exit(1);
});
`;var we=class we{getName(){return"esbuild"}async beforeStart(t){let e=or.default.resolve(t.projectDir,"scripts");await sr.default.mkdir(e)}getDevDependencies(){return[new l("esbuild")]}getConfigFiles(){return[new u(()=>ir,"build.mjs","scripts")]}packageJsonMiddleware(t){return t.addScript("build","node ./scripts/build.mjs"),t}};i(we,"EsbuildModule");var Gt=we;var ar=["/__mocks__","/__tests__","/.vscode","/coverage","/dist","/node_modules","/tests","/.eslintignore","/.eslintrc.json","/.gitignore","/.prettierrc.json","/jest.config.js","/package-lock.json","/tsconfig.json","/webpack.config.js","/yarn-error.log","/yarn.lock","/*.js","/*.mjs","/*.cjs","/scripts"].join(`
`);var cr={plugins:["@typescript-eslint"],env:{browser:!0,es2021:!0},extends:["prettier","eslint:recommended","plugin:@typescript-eslint/eslint-recommended","plugin:@typescript-eslint/recommended"],parser:"@typescript-eslint/parser",parserOptions:{project:"./tsconfig.json",sourceType:"module"},rules:{"max-len":["error",70,4,{ignoreUrls:!0,ignoreStrings:!0,ignoreRegExpLiterals:!0,ignoreTemplateLiterals:!0}],"linebreak-style":["error","unix"],quotes:["error","double",{avoidEscape:!0}],semi:["error","always"],"@typescript-eslint/consistent-type-imports":"error","@typescript-eslint/consistent-type-exports":"error","@typescript-eslint/member-delimiter-style":"error","@typescript-eslint/no-confusing-non-null-assertion":"error","@typescript-eslint/no-misused-new":"error","@typescript-eslint/no-require-imports":"error","@typescript-eslint/restrict-plus-operands":"error","@typescript-eslint/switch-exhaustiveness-check":"error","@typescript-eslint/no-base-to-string":"error","@typescript-eslint/prefer-nullish-coalescing":"warn","@typescript-eslint/require-array-sort-compare":"warn","@typescript-eslint/no-empty-interface":"off","@typescript-eslint/prefer-for-of":"off","@typescript-eslint/no-this-alias":"off","@typescript-eslint/no-non-null-assertion":"off","@typescript-eslint/no-explicit-any":"off","@typescript-eslint/unbound-method":"off","@typescript-eslint/explicit-module-boundary-types":"off","no-async-promise-executor":"off","@typescript-eslint/no-floating-promises":"off","@typescript-eslint/no-empty-function":"off","@typescript-eslint/no-namespace":"off","@typescript-eslint/ban-ts-comment":"off","no-constant-condition":"off","no-prototype-builtins":"off","no-control-regex":"off","@typescript-eslint/ban-types":["error",{types:{object:!1,Function:!1,"{}":!1},extendDefaults:!0}]}};var be=class be{getName(){return"eslint"}getDevDependencies(){return[new l("@typescript-eslint/eslint-plugin"),new l("@typescript-eslint/parser"),new l("eslint-config-prettier"),new l("eslint-plugin-prettier"),new l("eslint")]}getConfigFiles(){return[new u(()=>cr,".eslintrc.json"),new u(()=>ar,".eslintignore")]}packageJsonMiddleware(t){return t.addScript("fix:lint","eslint --fix ./src/**/*.ts"),t.addScript("test:lint","eslint ./src/**/*.ts"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Lint",script:"test:lint"})}};i(be,"EslintModule");var $t=be;var lr=f(require("fs/promises")),ur=f(require("path"));var pr=G`
/** @type {import("@reactgjs/gest/config").ConfigGetter} */
const getConfig = () => {
    return {
        testDir: "./__tests__",
        srcDir: "./src",
    };
};

export default getConfig;
`;var et={extends:"../tsconfig.json",include:["../**/*"],compilerOptions:{rootDir:"..",noEmit:!0}};var ye=class ye{getName(){return"gest"}async beforeStart(t){let e=ur.default.resolve(t.projectDir,"__tests__");await lr.default.mkdir(e)}getDevDependencies(){return[new l("@reactgjs/gest")]}getConfigFiles(){return[new u(()=>pr,"gest.config.mjs"),new u(()=>et,"tsconfig.json","__tests__")]}packageJsonMiddleware(t){return t.addScript("test:unit","gest"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Unit Tests",script:"test:unit"})}};i(ye,"GestModule");var Lt=ye;var dr=f(require("fs/promises")),gr=f(require("path"));var mr=G`
const fs = require("fs");
const path = require("path");

const swcConfig = JSON.parse(
  fs.readFileSync(path.resolve(__dirname, ".swcrc"), "utf-8")
);

/** @type {import("jest").Config} */
const config = {
  testRegex: ".*__tests__/.+(\\.test\\.(ts|js|tsx|jsx))$",
  transform: {
    "^.+\\.(js|jsx|ts|tsx)$": ["@swc/jest", swcConfig],
  },
  roots: ["<rootDir>"],
  collectCoverageFrom: ["src/**/*.(ts|js|tsx|jsx)"],
  coverageReporters: ["html", "text"],
  coverageThreshold: {
    global: {
      branches: 0,
      functions: 0,
      lines: 0,
      statements: 0,
    },
  },
  coveragePathIgnorePatterns: [
    "/node_modules/",
    "/coverage/",
    "/__mocks__/",
    "/__tests__/",
    "/dist/",
    "/.husky/",
    "/.vscode/",
  ],
};

module.exports = config;
`.trim()+`
`;var fr={jsc:{keepClassNames:!0,parser:{syntax:"typescript",tsx:!0,decorators:!0,dynamicImport:!1},target:"es2022",baseUrl:"."},module:{type:"es6",strict:!0}};var Ne=class Ne{getName(){return"jest"}async beforeStart(t){let e=gr.default.resolve(t.projectDir,"__tests__");await dr.default.mkdir(e)}getDevDependencies(){return[new l("@swc/core"),new l("@swc/jest"),new l("@types/jest"),new l("jest")]}getConfigFiles(){return[new u(()=>mr,"jest.config.js"),new u(()=>fr,".swcrc"),new u(()=>et,"tsconfig.json","__tests__")]}packageJsonMiddleware(t){return t.addScript("test:unit","jest --coverage"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Unit Tests",script:"test:unit"})}};i(Ne,"JestModule");var Ut=Ne;var Fr=f(require("fs/promises")),Pe=f(require("path"));var $n=Object.defineProperty,Ln=i((r,t,e)=>t in r?$n(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,"__defNormalProp"),Un=i((r,t,e)=>(Ln(r,typeof t!="symbol"?t+"":t,e),e),"__publicField"),rt,Nt=(rt=class{static parseRgbArgs(t){if(t.length===1){let e=t[0];if(typeof e=="string"){if(e.startsWith("rgb(")){let n=e.slice(4,-1).split(",");return{r:Number(n[0]),g:Number(n[1]),b:Number(n[2])}}else if(e.startsWith("#")){let n=e.slice(1).split("");return{r:parseInt(n[0]+n[1],16),g:parseInt(n[2]+n[3],16),b:parseInt(n[4]+n[5],16)}}}else if(typeof e=="object")return e}else if(t.length===3)return{r:t[0],g:t[1],b:t[2]};throw new Error("Invalid rgb arguments")}static get(t){return t in this.predefinedColors?this.predefinedColors[t]:this.rgb(t)}static define(t,...e){if(t in this.predefinedColors)throw new Error(`Color ${t} is already defined.`);Object.assign(this.predefinedColors,{[t]:this.rgb(...e)})}static rgb(...t){return""}},i(rt,"TermxColors"),rt);Un(Nt,"predefinedColors",{});var Hn=Object.defineProperty,Bn=i((r,t,e)=>t in r?Hn(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,"__defNormalProp"),Jn=i((r,t,e)=>(Bn(r,typeof t!="symbol"?t+"":t,e),e),"__publicField"),I="\x1B",nt,Ht=(nt=class extends Nt{static rgb(...t){let e=this.parseRgbArgs(t);return`${I}[48;2;${e.r};${e.g};${e.b}m`}},i(nt,"TermxBgColor"),nt);Jn(Ht,"predefinedColors",{unset:`${I}[0m`,red:`${I}[41m`,green:`${I}[42m`,yellow:`${I}[43m`,blue:`${I}[44m`,magenta:`${I}[45m`,cyan:`${I}[46m`,white:`${I}[47m`,lightRed:`${I}[101m`,lightGreen:`${I}[102m`,lightYellow:`${I}[103m`,lightBlue:`${I}[104m`,lightMagenta:`${I}[105m`,lightCyan:`${I}[106m`,lightWhite:`${I}[107m`});var Wn=Object.defineProperty,Vn=i((r,t,e)=>t in r?Wn(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,"__defNormalProp"),Kn=i((r,t,e)=>(Vn(r,typeof t!="symbol"?t+"":t,e),e),"__publicField"),C="\x1B",it,E=(it=class extends Nt{static rgb(...t){let e=this.parseRgbArgs(t);return`${C}[38;2;${e.r};${e.g};${e.b}m`}},i(it,"TermxFontColor"),it);Kn(E,"predefinedColors",{unset:`${C}[0m`,red:`${C}[31m`,green:`${C}[32m`,yellow:`${C}[33m`,blue:`${C}[34m`,magenta:`${C}[35m`,cyan:`${C}[36m`,white:`${C}[37m`,lightRed:`${C}[91m`,lightGreen:`${C}[92m`,lightYellow:`${C}[93m`,lightBlue:`${C}[94m`,lightMagenta:`${C}[95m`,lightCyan:`${C}[96m`,lightWhite:`${C}[97m`});function j(...r){let t=r[0],e="",n=0,o=0;for(e=t[0],n=1,o=r.length;n<o;n++)typeof r[n]=="object"&&r[n]!==null&&r[n].name==="RawHtml"?e+=r[n].toString()+t[n]:e+=qn(r[n].toString())+t[n];return e}i(j,"html");function qn(r){return r.replace(/</g,"&lt;").replace(/>/g,"&gt;")}i(qn,"sanitizeHtml");function hr(r){return r.replace(/&lt;/g,"<").replace(/&gt;/g,">")}i(hr,"desanitizeHtml");var ot,W=(ot=class extends Error{constructor(t,e,n){super("Invalid Markup. "+n),this.parsedMarkup=t,this.position=e}getPositionCords(){let t=0,e=0;for(let n=0;n<this.position;n++)this.parsedMarkup[n]===`
`?(t++,e=0):e++;return[t,e]}getStack(){return this.stack??""}getPositionPatch(){let[t,e]=this.getPositionCords(),n=this.parsedMarkup.split(`
`),o=n[t],s=" ".repeat(e)+"^",a="";return t>1&&(a+=n[t-2]+`
`),t>0&&(a+=n[t-1]+`
`),a+=o+`
`+s,a}toString(){return`${this.message}

${this.getPositionPatch()}

${this.getStack()}`}},i(ot,"MarkupParserError"),ot),at,br=(at=class{constructor(t){c(this,"o",{textNode:!1,tag:"",attributes:[],content:[]});c(this,"content",[]);c(this,"lastStringContent","");this.parent=t}addChild(){this.lastStringContent.length&&(this.content.push(this.lastStringContent),this.lastStringContent="");let t=new br(this);return this.content.push(t),t}addChar(t){this.lastStringContent+=t}serialize(){for(let t=0;t<this.content.length;t++){let e=this.content[t];typeof e=="string"?this.o.content.push(e):this.o.content.push(e.serialize())}return this.lastStringContent.length&&this.o.content.push(this.lastStringContent),this.o}},i(at,"MarkupNodeBuilder"),at),ct,zn=(ct=class{constructor(){c(this,"node",new br);this.node.o.textNode=!0}addChildNode(){this.node=this.node.addChild()}moveUp(){this.node=this.node.parent}isTopLevel(){return this.node.parent===void 0}serialize(){return this.node.content.length===1&&this.node.o.tag===""&&typeof this.node.content[0]!="string"?this.node.content[0].serialize():this.node.serialize()}},i(ct,"MarkupBuilder"),ct),yr=1,Nr=2,_r=4,ve=8,vr=16,Ie=32,st=~yr,Bt=~Nr,Yn=~_r,wr=~ve,Qn=~vr,_e=~Ie;function Ce(r){let t=new zn,e="",n="",o="",s=0;for(let a=0;a<r.length;a++){let m=r[a];switch(s){case 0:{switch(m){case"<":{s=s|yr,r[a+1]==="/"?(s=s|vr,a++):t.addChildNode();continue}case"\\":{s=s|ve;continue}}t.node.addChar(m);break}case 8:{t.node.addChar(m),s=s&wr;break}case 1:{switch(m){case`
`:{t.node.o.tag.length>0&&(s=s|Ie);continue}case" ":{t.node.o.tag.length>0&&(s=s|Ie);continue}case">":{if(t.node.o.tag.length===0)throw new W(r,a,"No tag name found.");s=s&st;continue}case"/":{if(r[a+1]===">")s=s&st,a++,t.moveUp();else throw new W(r,a,"Invalid character encountered.");continue}case"=":throw new W(r,a-t.node.o.tag.length,"No tag name found.")}t.node.o.tag+=m;break}case 33:{switch(m){case`
`:continue;case" ":continue;case">":{s=s&st&_e;continue}case"/":{if(r[a+1]===">")s=s&st&_e,a++,t.moveUp();else throw new W(r,a,"Invalid character encountered.");continue}case"=":throw new W(r,a,"Invalid character encountered.")}s=s|Nr,e+=m;break}case 17:{switch(m){case`
`:continue;case" ":continue;case">":{if(s=s&st&Qn,o!==t.node.o.tag)throw new W(r,a,`Closing tag does not match opening tag, expected '${t.node.o.tag}' but found '${o}'.`);o="",t.moveUp();continue}}o+=m;break}case 35:{switch(m){case"=":{if(s=s&Bt,r[a+1]==='"')s=s|_r,a+=1;else throw new W(r,a+1,"Attribute values must be enclosed in double quotes.");continue}case`
`:{s=s&Bt,t.node.o.attributes.push([e,!0]),e="";continue}case" ":{s=s&Bt,t.node.o.attributes.push([e,!0]),e="";continue}case">":{s=s&st&Bt&_e,t.node.o.attributes.push([e,!0]),e="";continue}}e+=m;break}case 37:{switch(m){case'"':{s=s&Yn,t.node.o.attributes.push([e,n]),e="",n="";continue}case"\\":{s=s|ve;continue}}n+=m;break}case 45:{n+=m,s=s&wr;break}}}if(!t.isTopLevel())throw new W(r,r.length-1,`Closing tag is missing. Expected a close tag for '${t.node.o.tag}' before the end of the document.`);return t.serialize()}i(Ce,"parseMarkup");var Jt=i((r,t,e=" ")=>{e=e[0]??" ";let n=e.repeat(t);return r.split(`
`).map(s=>`${n}${s}`).join(`
`)},"leftPad");var Zn=Object.defineProperty,Xn=i((r,t,e)=>t in r?Zn(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,"__defNormalProp"),Ir=i((r,t,e)=>(Xn(r,typeof t!="symbol"?t+"":t,e),e),"__publicField"),pt,Cr=(pt=class{static get currentScope(){return this._currentScope}static enterScope(t){let e=t;this.scopeStack.push(e),this._currentScope=e}static exitScope(){this.scopeStack.pop(),this._currentScope=this.scopeStack[this.scopeStack.length-1]??{}}static traverseUp(t){for(let e=this.scopeStack.length-1;e>=0;e--)t(this.scopeStack[e])}},i(pt,"_ScopeTracker"),pt),v=Cr;Ir(v,"scopeStack",[{tag:""}]);Ir(v,"_currentScope",Cr.scopeStack[0]);var q="\x1B",ti=`${q}[1m`,ei=`${q}[2m`,ri=`${q}[3m`,ni=`${q}[4m`,ii=`${q}[5m`,si=`${q}[7m`,oi=`${q}[9m`,lt,Oe=(lt=class{static defineColor(t,...e){Ht.define(t,...e),E.define(t,...e)}static format(t){let e=Ce(t);return E.get("unset")+hr(this.formatMarkup(e))}static formatMarkup(t){let e="";switch(t.tag){case"li":case"pre":case"line":case"span":return v.enterScope(this.createScope(t)),e+=this.scopeToAnsi(v.currentScope)+this.join(t.content.map(n=>this.mapContents(n,t.tag==="pre"))),v.exitScope(),e+=E.get("unset"),t.tag==="line"&&(e+=`
`),e+=this.scopeToAnsi(v.currentScope),e;case"ol":case"ul":{let n=this.getListElementPrefix(t),o=this.getListPadding();return v.enterScope(this.createScope(t)),e+=this.scopeToAnsi(v.currentScope)+this.join(t.content.filter(s=>typeof s!="string"||s.trim().length).map((s,a)=>{if(typeof s=="string"||s.tag!=="li")throw new Error(`Invalid element inside <${t.tag}>. Each child of <${t.tag}> must be a <li> element.`);let{contentPad:m,firstLineOffset:d}=this.getContentPad(t,a+1),g=n(a)+Jt(this.mapContents(s),m).substring(d);return Jt(g,o)+`
`})),v.exitScope(),e+=E.get("unset")+this.scopeToAnsi(v.currentScope),e}case"pad":{v.enterScope(this.createScope(t));let n=this.getAttribute(t,"size")??0,o=this.scopeToAnsi(v.currentScope)+this.join(t.content.map(s=>this.mapContents(s)));return e+=Jt(o,Number(n)),v.exitScope(),e+=E.get("unset")+this.scopeToAnsi(v.currentScope),e}case"br":return e+`
`;case"s":return e+" ";case"":return e+=this.join(t.content.map(n=>this.mapContents(n))),e}throw new Error(`Invalid tag: <${t.tag}>`)}static join(t){let e="";for(let n=0;n<t.length;n++)e+=t[n];return e}static getAttribute(t,e){for(let[n,o]of t.attributes)if(n===e)return Se(o,"string")}static mapContents(t,e){return typeof t=="string"?e?t:t.replaceAll(`
`,"").trim():this.formatMarkup(t)}static getListPadding(){let t=0;return v.traverseUp(e=>{(e.tag==="ol"||e.tag==="ul")&&(t+=1)}),t===0?0:(t-1)*2}static getContentPad(t,e){if(t.tag==="ul")return{contentPad:2,firstLineOffset:2};let n=t.content.length.toString().length,o=t.content.length.toString().length+2;return{contentPad:o,firstLineOffset:o-(n-e.toString().length)}}static getListElementPrefix(t){if(t.tag==="ol")return o=>`${o+1}. `;let e=this.getAttribute(t,"type")??"bullet",n=(()=>{switch(e){case"bullet":return"\u25CF";case"circle":return"\u25CB";case"square":return"\u25A1";default:throw new Error(`Invalid list type: ${e}`)}})();return()=>`${n} `}static scopeToAnsi(t){let e="";return t.noInherit&&(e+=E.get("unset")),t.color&&(e+=E.get(t.color)),t.bg&&(e+=Ht.get(t.bg)),t.bold&&(e+=ti),t.dimmed&&(e+=ei),t.italic&&(e+=ri),t.underscore&&(e+=ni),t.blink&&(e+=ii),t.inverted&&(e+=si),t.strikethrough&&(e+=oi),e}static createScope(t){let n=t.attributes.some(([o,s])=>o==="no-inherit"&&(s===!0||s==="true"))?{noInherit:!0}:{...v.currentScope,noInherit:!1};t.tag&&(n.tag=t.tag);for(let[o,s]of t.attributes)switch(o){case"color":n.color=Se(s,"string");break;case"bg":n.bg=Se(s,"string");break;case"bold":n.bold=s===!0||s==="true";break;case"dim":n.dimmed=s===!0||s==="true";break;case"italic":n.italic=s===!0||s==="true";break;case"underscore":n.underscore=s===!0||s==="true";break;case"blink":n.blink=s===!0||s==="true";break;case"invert":n.inverted=s===!0||s==="true";break;case"strike":n.strikethrough=s===!0||s==="true";break}return n}},i(lt,"MarkupFormatter"),lt);function Se(r,t){if(typeof r===t)return r;throw new Error(`Invalid attribute type: ${typeof r} (expected ${t})`)}i(Se,"as");var ai=Object.defineProperty,ci=i((r,t,e)=>t in r?ai(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,"__defNormalProp"),Te=i((r,t,e)=>(ci(r,typeof t!="symbol"?t+"":t,e),e),"__publicField"),ut,V=(ut=class{constructor(t){c(this,"_printFn");if(t)this._printFn=t;else if(V.defaultPrintFn)this._printFn=V.defaultPrintFn;else if(typeof print=="function")this._printFn=print;else if(typeof console<"u"&&console.log)this._printFn=e=>console.log(e);else throw new Error("Unable to detect print function for current environment.")}static print(...t){V.globalOutput.print(...t)}static println(...t){V.globalOutput.println(...t)}static setDefaultPrintMethod(t){V.defaultPrintFn=t,V.globalOutput=new V(t)}printError(t){t!=null&&(this._printFn(t.toString()+`
`),typeof t=="object"&&t.stack&&this._printFn(t.stack+`
`))}parseMarkupLines(t){let e=[];for(let n of t)e.push(Oe.format(n));return e}print(...t){try{let e=this.parseMarkupLines(t);for(let n of e)this._printFn(n)}catch(e){this._printFn(E.get("red")+"Failed to format/print given markup."+E.get("unset")+`
`),this.printError(e)}}println(...t){try{let e=this.parseMarkupLines(t);for(let n of e)this._printFn(n+`
`)}catch(e){this._printFn(E.get("red")+"Failed to format/print given markup."+E.get("unset")+`
`),this.printError(e)}}},i(ut,"_Output"),ut),S=V;Te(S,"defaultPrintFn");Te(S,"globalOutput");try{S.globalOutput=new S}catch{}var mt,Wt=(mt=class{constructor(t=S){c(this,"buffer",[]);this.output=t}static print(t){Wt.globalOutputBuffer.print(t)}static println(t){Wt.globalOutputBuffer.println(t)}print(...t){this.buffer.push(...t.map(e=>({type:"print",markup:e})))}println(...t){this.buffer.push(...t.map(e=>({type:"println",markup:e})))}flush(){for(let{type:t,markup:e}of this.buffer)switch(t){case"print":this.output.print(e);break;case"println":this.output.println(e);break}this.buffer=[]}pipe(t){return this.buffer.length===0||(t.buffer.push(...this.buffer),this.buffer=[]),t}pipeReverse(t){return t.buffer.length===0?this:(this.buffer.push(...t.buffer),t.buffer=[],this)}},i(mt,"_OutputBuffer"),mt),Sr=Wt;Te(Sr,"globalOutputBuffer",new Wt);var Or=i(async r=>{S.print(j`
    <span color="lightGreen">Configuring:</span>
    <pre> git-hook-tasks</pre>
  `),await r.run("git-hook-tasks","install","-p",r.getName())},"configureGitHookTasks");var Tr=i(r=>{let t=[{name:"TypeScript",script:"test:tsc"}];return{packageManager:r.packageManager.getName(),parallel:!0,hooks:{"pre-push":t,"pre-commit":[],"post-commit":[]}}},"getGitHookTasksConfig");var Pr=["/node_modules","/coverage","/dist","/yarn-error.log","/.yarn/cache","/.yarn/install-state.gz"].join(`
`);var xr=i(r=>`MIT License

  Copyright (c) ${new Date().getFullYear()}${r.authorName?` ${r.authorName}`:""}
  
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  
  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.
  
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.`,"getLicense");var Mr=`
//registry.npmjs.org/:_authToken=\${NPM_TOKEN}
`.trim();var Er=["/__mocks__","/__tests__","/.github","/.husky","/.vscode","/coverage","/scripts","/src","/.editorconfig","/.eslintignore","/.eslintrc.json","/.gitignore","/.prettierignore","/.prettierrc.json","/.yarn","/.yarnrc.yml","/git-hook-tasks.config.json","/jest.config.js","/tsconfig.json","/yarn-error.log"].join(`
`);var kr={compilerOptions:{target:"ESNext",module:"ES6",moduleResolution:"node",jsx:"react",declaration:!0,outDir:"./dist",rootDir:"./src",downlevelIteration:!0,strict:!0,noUnusedLocals:!0,noUncheckedIndexedAccess:!0,esModuleInterop:!0,skipLibCheck:!0,forceConsistentCasingInFileNames:!0,isolatedModules:!0,noImplicitAny:!0},include:["src/**/*"]};var Ar={"editor.formatOnSave":!0,"editor.codeActionsOnSave":["source.organizeImports","source.fixAll.eslint"]};var xe=class xe{getName(){return"Main"}async beforeStart(t){let e=Pe.default.resolve(t.projectDir,".vscode");switch(await Fr.default.mkdir(e),t.packageManager.getName()){case"yarn":{await t.packageManager.changeVersion("classic");break}case"bun":{await t.packageManager.run("init","--yes");break}}}getDevDependencies(t){return[new l("typescript"),new l("husky",{version:"~8"}),new l("git-hook-tasks",{register:"github",user:"ncpa0cpl",version:"0.0.1"})]}getConfigFiles(){return[new u(()=>Pr,".gitignore"),new u(()=>kr,"tsconfig.json"),new u(()=>Mr,".npmrc"),new u(()=>Er,".npmignore"),new u(xr,"LICENSE"),new u(Tr,"git-hook-tasks.config.json"),new u(()=>Ar,"settings.json",".vscode")]}async afterEnd(t){if(t.packageManager.getName()!=="bun")await Or(t.packageManager);else{await t.packageManager.run("husky","install"),await t.packageManager.run("husky","add",".husky/pre-push",`"${await t.packageManager.generateCommand("git-hook-tasks pre-push")}"`);let e=Bun.file(Pe.default.join(t.packageManager.wd(),".husky/pre-push"));await Bun.write(e,await e.text().then(n=>n.replace(/\\/g,"")))}}};i(xe,"MainModule");var Vt=xe;var jr=f(require("fs/promises")),Rr=f(require("path"));var Dr=G`
import { build } from "@ncpa0cpl/nodepack";
import path from "node:path";
import { fileURLToPath } from "url";

const __dirname = path.dirname(fileURLToPath(import.meta.url));
const p = (...fpath) => path.resolve(__dirname, "..", ...fpath);

const isDev = process.argv.includes("--dev");
const watch = process.argv.includes("--watch");

async function main() {
  /**
   * @type {import("@ncpa0cpl/nodepack").BuildConfig}
   */
  const bldOptions = {
    tsConfig: p("tsconfig.json"),
    srcDir: p("src"),
    outDir: p("dist"),
    target: "ESNext",
    formats: ["esm", "cjs", "legacy"],
    declarations: true,
    watch: watch,
    esbuildOptions: {
      minify: !isDev,
      sourcemap: isDev ? "inline" : false,
    }
  }

  await build(bldOptions);
}

main().catch((err) => {
  console.error(err);
  process.exit(1);
});
`;var Me=class Me{getName(){return"nodepack"}async beforeStart(t){let e=Rr.default.resolve(t.projectDir,"scripts");await jr.default.mkdir(e)}getDevDependencies(){return[new l("esbuild"),new l("@ncpa0cpl/nodepack")]}getConfigFiles(){return[new u(()=>Dr,"build.mjs","scripts")]}packageJsonMiddleware(t){return t.addScript("build","node ./scripts/build.mjs"),t}};i(Me,"NodepackModule");var Kt=Me;var Ee=class Ee{getName(){return"oxlint"}getDevDependencies(){return[new l("oxlint")]}getConfigFiles(){return[]}packageJsonMiddleware(t){return t.addScript("fix:lint","oxlint --fix ./src"),t.addScript("test:lint","oxlint ./src"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Lint",script:"test:lint"})}};i(Ee,"OxlintModule");var qt=Ee;var Gr=["**/*.json"].join(`
`);var $r=G`
/**
 * @type {import("prettier").Options}
 */
const config = {
  bracketSpacing: true,
  tabWidth: 2,
  semi: true,
  singleQuote: false,
  printWidth: 70,
  singleAttributePerLine: true,
  plugins: ["./node_modules/prettier-plugin-jsdoc/dist/index.js"],
  jsdocSingleLineComment: false,
};

export default config;
`;var ke=class ke{getName(){return"prettier"}getDevDependencies(){return[new l("prettier-plugin-jsdoc"),new l("prettier")]}getConfigFiles(){return[new u(()=>$r,".prettierrc.mjs"),new u(()=>Gr,".prettierignore")]}packageJsonMiddleware(t){return t.addScript("fix:fmt","prettier -w ./src/**/*.ts"),t.addScript("test:fmt","prettier -c ./src/**/*.ts"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Check Formatting",script:"test:fmt"})}};i(ke,"PrettierModule");var zt=ke;var Ae=class Ae{getName(){return"build-tsc"}packageJsonMiddleware(t){return t.addScript("build","tsc"),t}};i(Ae,"TscBuilderModule");var Yt=Ae;var Ur=f(require("fs/promises")),Hr=f(require("path"));var Lr=`
import { defineConfig } from "vitest/config";

export default defineConfig({
  test: {
    clearMocks: true,
    dir: "__tests__",
  },
});
`.trimStart();var Fe=class Fe{getName(){return"vitest"}async beforeStart(t){let e=Hr.default.resolve(t.projectDir,"__tests__");await Ur.default.mkdir(e)}getDevDependencies(){return[new l("vitest")]}getConfigFiles(){return[new u(()=>Lr,"vitest.config.mts"),new u(()=>et,"tsconfig.json","__tests__")]}packageJsonMiddleware(t){return t.addScript("test:unit","vitest run"),t}beforeWriteFile(t,e){t==="git-hook-tasks.config.json"&&M(e)&&e.hooks["pre-push"].push({name:"Unit Tests",script:"test:unit"})}};i(Fe,"VitestModule");var Qt=Fe;var Br=i(()=>`
enableGlobalCache: true

nodeLinker: node-modules

enableMessageNames: false

enableProgressBars: true
`.trim()+`
`,"getYarnRc");var De=class De{getName(){return"yarn3"}getConfigFiles(){return[new u(Br,".yarnrc.yml")]}async beforeStart(t){return await t.packageManager.changeVersion("stable")}};i(De,"YarnBerryModule");var Zt=De;var pi=new Vt,_t=class _t{constructor(t){this.loadedModules=[pi];t.moduleList==="default"&&(t.moduleList="dprint,nodepack,vitest");let e=t.moduleList.split(",").filter(n=>!!n);for(let n of e){let o=_t.Modules.find(s=>s.getName()===n);o||(console.error(`'${n}' is not a valid module`),process.exit(1)),this.loadedModules.includes(o)||this.loadedModules.push(o)}this.ctx={allLoadedModules:this.loadedModules.map(n=>n.getName()),packageManager:t.packageManager,projectName:t.projectName,authorName:t.authorName,projectDir:""}}static listAvailableModules(){return this.Modules.map(t=>t.getName()).join(", ")}getContext(){return this.ctx}async beforeStart(t){this.ctx.projectDir=t,Object.freeze(this.ctx);for(let e of this.loadedModules)e.beforeStart&&await e.beforeStart(this.ctx)}async afterEnd(){for(let t of this.loadedModules)t.afterEnd&&await t.afterEnd(this.ctx)}getDependencies(){return this.loadedModules.flatMap(t=>t.getDependencies?.(this.ctx)).filter(t=>t!=null)}getDevDependencies(){return this.loadedModules.flatMap(t=>t.getDevDependencies?.(this.ctx)).filter(t=>t!=null)}prepareFile(t){let e=this.loadedModules.reduce((n,o)=>o.beforeWriteFile?.(t.filename,n,this.ctx)??n,t.getContent(this.ctx));return{filepath:Jr.default.join(t.location,t.filename),content:typeof e=="string"?e:JSON.stringify(e,null,2)}}getConfigFiles(){return this.loadedModules.flatMap(t=>t.getConfigFiles?.(this.ctx)).filter(t=>t!=null).map(t=>this.prepareFile(t))}async applyPackageJsonMiddleware(t){let e=t;for(let n of this.loadedModules)n.packageJsonMiddleware&&(e=await n.packageJsonMiddleware(e,this.ctx));return e}};i(_t,"ModuleController"),_t.Modules=[new Gt,new Yt,new Kt,new $t,new qt,new zt,new Rt,new Ut,new Qt,new Lt,new Zt];var ft=_t;var Wr=(0,vt.defineOption)({char:"p",name:"package-manager",type:"string",default:"yarn",required:!0,description:"Package manager used to install dependencies. (yarn, bun or npm)",validate(r){return["yarn","bun","npm"].includes(r)?"ok":{expected:"yarn | bun | npm",received:r}}}),Vr=(0,vt.defineOption)({char:"n",name:"name",type:"string",required:!0,description:"The name of the project."}),Kr=(0,vt.defineOption)({char:"a",name:"author",type:"string",description:"Name of the author."}),qr=(0,vt.defineOption)({char:"m",name:"modules",type:"string",description:`Comma separated list of modules. Available modules: ${ft.listAvailableModules()}`});var dt=f(require("fs/promises")),Ct=f(require("path"));var zr=f(require("child_process")),je=f(require("fs/promises")),Re=f(require("path"));var A=i(r=>r.map(t=>t.replace(/\s/g,"\\ ")).join(" "),"parseArgs");var li=["run","test","x","repl","install","add","remove","update","link","unlink","pm","build","init","create","upgrade"],O,Yr=(O=class{static getName(){return"bun"}static async execute(t){return new Promise((e,n)=>{zr.default.exec(t,{cwd:O.cwd},(o,s,a)=>o?n(new Error(a)):e(s))})}static async getVersion(){return""}static async changeVersion(t){}static setCwd(t){O.cwd=t}static wd(){return O.cwd}static async init(){await je.default.writeFile(Re.default.resolve(O.cwd,"package.json"),JSON.stringify({packageManager:"bun"},null,2))}static install(t){let e=[];return e.push(t),O.run("add",...e)}static installDev(t){let e=["-d"];return e.push(t),O.run("add",...e)}static async run(t,...e){return O.execute(await O.generateCommand(t,...e))}static async generateCommand(t,...e){let n=Re.default.resolve(O.cwd,"package.json"),o=[];try{let s=await je.default.readFile(n,{encoding:"utf-8"}),a=JSON.parse(s);o.push(...Object.keys(a.scripts))}catch{}return o.includes(t)?A(["bun","run",t,...e]):li.includes(t)?A(["bun",t,...e]):A(["bun","x",t,...e])}},i(O,"BunPM"),O.cwd=process.cwd(),O);var Qr=f(require("child_process")),Ge=f(require("fs/promises")),$e=f(require("path"));var T,Zr=(T=class{static getName(){return"npm"}static execute(t){return new Promise((e,n)=>{Qr.default.exec(t,{cwd:T.cwd},(o,s,a)=>o?n(new Error(a)):e(s))})}static async init(){await Ge.default.writeFile($e.default.resolve(T.cwd,"package.json"),JSON.stringify({packageManager:"npm"},null,2))}static async changeVersion(){}static async getVersion(){return""}static setCwd(t){T.cwd=t}static wd(){return T.cwd}static install(t){let e=["npm","install"];return e.push(t),T.execute(A(e))}static installDev(t){let e=["npm","install","-D"];return e.push(t),T.execute(A(e))}static async run(t,...e){return T.execute(await T.generateCommand(t,...e))}static async generateCommand(t,...e){let n=$e.default.resolve(T.cwd,"package.json"),o=[];try{let s=await Ge.default.readFile(n,{encoding:"utf-8"}),a=JSON.parse(s);o.push(...Object.keys(a.scripts))}catch{}if(o.includes(t)){let s=["npm","run",t];return e.length>0&&(s.push("--"),s.push(...e)),A(s)}return A(["npx",t,...e])}},i(T,"Npm"),T.cwd=process.cwd(),T);var Xr=f(require("child_process")),tn=f(require("fs/promises")),en=f(require("path"));var y,rn=(y=class{static getName(){return"yarn"}static async execute(t){return new Promise((e,n)=>{Xr.default.exec(t,{cwd:y.cwd},(o,s,a)=>o?n(new Error(a)):e(s))})}static async getVersion(){return y.version?y.version:(this.version=await y.run("-v"),this.version.trim())}static async changeVersion(t){await y.run("set","version",t),this.version=void 0,await y.getVersion()}static setCwd(t){y.cwd=t}static wd(){return y.cwd}static async init(){let t=await y.getVersion();if(await tn.default.writeFile(en.default.resolve(y.cwd,"package.json"),JSON.stringify({packageManager:`yarn@${t}`},null,2)),t.startsWith("3"))return y.run("init")}static install(t){let e=[];return e.push(t),y.run("add",...e)}static installDev(t){let e=["-D"];return e.push(t),y.run("add",...e)}static async run(t,...e){return y.execute(await y.generateCommand(t,...e))}static async generateCommand(t,...e){return["yarn",t,...e].map(n=>n.replace(" ","\\ ")).join(" ")}},i(y,"Yarn"),y.cwd=process.cwd(),y);var nn=i(r=>{switch(r){case"npm":return Zr;case"yarn":return rn;case"bun":return Yr}console.error(`Invalid package manager argument: (${r})`),process.exit(1)},"getPackageManager");var sn=f(require("child_process"));var H=class H{static async execute(t){await new Promise((e,n)=>{sn.default.exec(t,{cwd:H.cwd},o=>o?n(o):e())})}static setCwd(t){H.cwd=t}static init(t){return H.setCwd(t),H.execute(A(["git","init"]))}static add(...t){t.length===0&&t.push("."),H.execute(A(["git","add",...t]))}};i(H,"Git"),H.cwd=process.cwd();var It=H;var on=f(require("fs/promises")),an=f(require("path"));var cn=i(async(r,t)=>{S.print(j`
      <span color="lightGreen">Generating:</span>
      <pre> config files</pre>
    `);let e=t.getConfigFiles().map(async n=>{await on.default.writeFile(an.default.resolve(r,n.filepath),n.content)});return Promise.all(e)},"createConfigFiles");var Ue=f(require("fs/promises")),pn=f(require("path"));var Le=class Le{constructor(t={}){this.packageJson=t}addScript(t,e){Object.defineProperty(this.packageJson.scripts,t,{value:e,enumerable:!0})}addIfNotExists(t,e){t in this.packageJson||Object.defineProperty(this.packageJson,t,{value:e,enumerable:!0})}toJSON(){return JSON.stringify(this.packageJson,null,2)}};i(Le,"PkgJsonFacade");var Xt=Le;var ln=i(async(r,t)=>{S.print(j`
    <span color="lightGreen">Generating:</span>
    <pre> package.json file</pre>
  `);let e=t.getContext(),n=pn.default.resolve(r,"package.json"),o=await Ue.default.readFile(n,{encoding:"utf-8"}),s=JSON.parse(o),a=new Xt({name:e.projectName,version:"1.0.0",main:"./dist/index.js",keywords:[],repository:{type:"git",url:""},description:"",license:"MIT",author:{name:e.authorName??"",email:""},scripts:{"test:tsc":"tsc --noEmit",prepare:"husky install"}});for(let[m,d]of Object.entries(s))a.addIfNotExists(m,d);return await t.applyPackageJsonMiddleware(a).then(m=>Ue.default.writeFile(n,m.toJSON()))},"updatePackageFile");var un=i(async r=>{let{projectName:t,authorName:e,rootDir:n,packageManager:o,modules:s}=r,a=nn(o.value),m=new ft({moduleList:s.value??"",packageManager:a,projectName:t.value,authorName:e.value}),d=Ct.default.resolve(n,t.value),g=Ct.default.resolve(d,"src"),gt=Ct.default.resolve(d,"dist"),_=Ct.default.resolve(g,"index.ts");(await dt.default.readdir(n)).includes(t.value)&&(console.error(`Directory with the name "${t.value}" already exists.`),process.exit(1)),await dt.default.mkdir(d),a.setCwd(d),await a.init(),await m.beforeStart(d),await It.init(d),S.print(j`
    <span color="lightGreen">Generating:</span>
    <pre color="lightYellow"> ${t.value} </pre>
    <span>project files</span>
  `),await Promise.all([dt.default.mkdir(g),dt.default.mkdir(gt),cn(d,m)]),await dt.default.writeFile(_,""),l.setPackageManagerType(a.getName(),await a.getVersion());for(let w of m.getDependencies())S.print(j`
      <span color="lightGreen">Installing dependency:</span>
      <pre> ${w.getFriendlyName()}</pre>
    `),await a.install(w.getInstallName());for(let w of m.getDevDependencies())S.print(j`
      <span color="lightGreen">Installing development dependency:</span>
      <pre> ${w.getFriendlyName()}</pre>
    `),await a.installDev(w.getInstallName());await ln(d,m),await m.afterEnd(),await It.add()},"mainAction");var ui="generate-new-project",mi="Generate a new Typescript project.",fi=mn.configure(r=>{r.setName(ui),r.setDescription(mi),r.main(t=>{let e=t.option(Wr),n=t.option(Vr),o=t.option(Kr),s=t.option(qr),a=t.input();return()=>un({rootDir:fn.default.resolve(a.get()),packageManager:e,projectName:n,authorName:o,modules:s})})});fi.run();
